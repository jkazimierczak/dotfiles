{{- if eq .chezmoi.os "linux" -}}
#!/usr/bin/env bash

{{ template "shared_script_utils.bash" . }}

VERBOSE=false
PACKAGE="fx"
REPOSITORY="antonmedv/${PACKAGE}"

_installOrUpdateUv_() {
    header "Verify ${PACKAGE} installation and check for updates"

    VERSION=$(gh release view --repo "$REPOSITORY" --json tagName --jq .tagName)
    VLESS_VERSION=$(echo "$VERSION" | sed 's/v//g')

    if [[ $(command -v $PACKAGE) ]]; then
        CURRENT_VERSION=$($PACKAGE --version)

        if [[ "$CURRENT_VERSION" == "$VLESS_VERSION" ]]; then
            info "${PACKAGE} is up to date"
            _safeExit_ 0
        fi
    fi

    _makeTempDir_ "$(basename "$0")"
    pushd "${TMP_DIR}" &>/dev/null || exit

    gh release download \
      --repo "$REPOSITORY" "$VERSION" \
      --pattern "fx_linux_amd64"

    mv "fx_linux_amd64" "${HOME}/bin/fx"
    chmod +x "${HOME}/bin/fx"

    popd &>/dev/null || exit

    success "${PACKAGE} installed successfully"
}

_installOrUpdateUv_
_safeExit_ 0
{{ end }}
